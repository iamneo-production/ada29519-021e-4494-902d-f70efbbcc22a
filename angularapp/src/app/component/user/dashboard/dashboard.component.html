<app-user></app-user>

<body>
  <div class="popup-container" *ngIf="successmessage">
    <span class="alert alert-success" role="alert">
      <i class="bi bi-check-circle-fill"></i>      {{successmessage}}
    </span>
  </div>
  <div class="popup-container" *ngIf="errormessage">
    <span class="alert alert-danger" role="alert"  (click)="errpopup()">
      <i class="bi bi-x-square-fill" ></i>      {{errormessage}}
    </span>
  </div>
  <br>
  <div class="row" id="dashBoardBody">
    <div class="container col">
      <div class="card-container">
        <div class="card" id="{{grid}}">
          <img src={{serviceimage}} alt="Image" width="450" height="250" class="img" id="productImage">
          <div class="card-details">
            <h3 style="text-transform: capitalize; text-align: center;" >{{serviceName}}</h3>
            <h3 style="text-align: center;">{{ getStarRating(getAverageRating(servicemailid)) }}</h3>
            <hr>           
            <p><b>Mail :</b> {{ servicemailid }}</p>
            <p><b>Phone :</b> {{ servicePhone }}</p>
            <p><b>Description:</b> {{servicecenterdescription}}
              </p>
            <p><b>Timing :</b> 00:00-23:59</p>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div class="container col">
      <div class="form">
        <h1>Enter the  AC details</h1><br>
        <form [formGroup]="productdetails">
          <label><h5>Enter Name of AC:</h5></label>
          <input type="text" placeholder="Enter the name of the AC" id="enterProductName" formControlName="productName">
          <small *ngIf="productdetails.controls['productName'].dirty && productdetails.hasError('required','productName')">Product name is required</small><br>
          <small *ngIf="productdetails.controls['productName'].dirty && productdetails.hasError('pattern','productName')">Invalid Product Name</small><br>
          <label><h5>Enter the Model number of AC:</h5></label>
          <input type="text" placeholder="Enter the Model number of the AC" id="enterModelNo" formControlName="productModelNo">          
          <small *ngIf="productdetails.controls['productModelNo'].dirty && productdetails.hasError('pattern','productModelNo')">Invalid Model Number</small><br>
          <small *ngIf="productdetails.controls['productModelNo'].dirty && productdetails.hasError('required','productModelNo')">Model Number is required</small><br>

          <label><h5>Enter Date of Purchase of AC:</h5></label>
          <input type="date" placeholder="Enter the Date of Purchase" id="enterDateOfPurchase" formControlName="dateOfPurchase"(change)="onDateSelected()" [max]="tdy">
          <small *ngIf="productdetails.controls['dateOfPurchase'].dirty && productdetails.hasError('required','dateOfPurchase')">Product Date Of Purchase is required</small><br>
          <small *ngIf="productdetails.controls['dateOfPurchase'].dirty && productdetails.hasError('pattern','dateOfPurchase')">Date Format should be (MM/DD/YYYY)</small><br>
          <label><h5>Enter the Contact Number:</h5></label>
          <input type="tel" placeholder="Enter the Contact Number" id="enterContactNumber" formControlName="contactNumber">
          <small *ngIf="productdetails.controls['contactNumber'].dirty && productdetails.hasError('required','contactNumber')">Contact Number is required</small><br>
          <small *ngIf="productdetails.controls['contactNumber'].dirty && productdetails.hasError('pattern','contactNumber')">Invalid Contact Number (10 digits only)</small><br>
          <label><h5>Enter Problem Description of AC:</h5></label>
          <textarea placeholder="Enter Problem of the AC" id="enterProblem" formControlName="problemDescription"></textarea>
          <small *ngIf="productdetails.controls['problemDescription'].dirty && productdetails.hasError('required','problemDescription')">Problem Description is required</small><br>
          <small *ngIf="productdetails.controls['problemDescription'].dirty && productdetails.hasError('pattern','problemDescription')">Only Alphabets allowed</small><br>

          <br>

          <label><h5>Book the Slots</h5></label>
          <div class="slots">
            <select id="selectDate" formControlName="date" placeholder="Choose the DATE">
              <option value="" disabled selected>Select a date</option>
              <ng-container *ngFor="let slot of availableSlots">
                <option [value]="slot.date">{{ slot.date }}</option>
              </ng-container>
            </select>
            <small *ngIf="productdetails.controls['date'].dirty && productdetails.hasError('required', 'date')">
              Date is required
            </small>
            <select id="selectTime" formControlName="time" placeholder="Choose the time slot">
              <option value="" disabled selected>Select a time</option>
              <ng-container *ngFor="let slot of availableSlots">
                <ng-container *ngIf="slot.date === productdetails.value.date">
                  <option *ngFor="let timeSlot of slot.times" [value]="timeSlot.time" [disabled]="timeSlot.isBooked">
                    {{ timeSlot.time }}
                  </option>
                </ng-container>
              </ng-container>
            </select>
            <small *ngIf="productdetails.controls['time'].dirty && productdetails.controls['time'].hasError('required')"> Time is required </small>
          </div>
          <button (click)="onbook()" type="submit" id="bookButton">BOOK</button>
        </form>
      </div>
    </div>
  </div>
  <br>
</body>